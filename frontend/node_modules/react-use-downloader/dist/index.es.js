import{useState as e,useRef as n,useCallback as t,useMemo as r}from"react";var o=function(){return o=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},o.apply(this,arguments)};function a(e,n,t,r){return new(t||(t=Promise))((function(o,a){function u(e){try{i(r.next(e))}catch(e){a(e)}}function c(e){try{i(r.throw(e))}catch(e){a(e)}}function i(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(u,c)}i((r=r.apply(e,n||[])).next())}))}function u(e,n){var t,r,o,a,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(i){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(u=0)),u;)try{if(t=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return u.label++,{value:c[1],done:!1};case 5:u.label++,r=c[1],c=[0];continue;case 7:c=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){u=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){u.label=c[1];break}if(6===c[0]&&u.label<o[1]){u.label=o[1],o=c;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(c);break}o[2]&&u.ops.pop(),u.trys.pop();continue}c=n.call(e,u)}catch(e){c=[6,e],r=0}finally{t=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}}var c=function(e){var n=e.setSize,t=e.setControllerCallback,r=e.setPercentageCallback,o=e.setErrorCallback;return function(e){if(!e.ok)throw Error("".concat(e.status," ").concat(e.type," ").concat(e.statusText));if(!e.body)throw Error("ReadableStream not yet supported in this browser.");var c=e.body,i=e.headers.get("content-encoding"),l=e.headers.get(i?"x-file-size":"content-length"),s=parseInt(l||"0",10);n((function(){return s}));var f=0,d=new ReadableStream({start:function(e){t(e);var n=c.getReader();return function t(){return a(this,void 0,void 0,(function(){return u(this,(function(a){return[2,n.read().then((function(n){var o=n.done,a=n.value;return o?e.close():(f+=(null==a?void 0:a.byteLength)||0,a&&e.enqueue(a),r({loaded:f,total:s}),t())})).catch((function(t){return o(t),n.cancel("Cancelled"),e.error(t)}))]}))}))}()}});return new Response(d)}},i=function(e,n,t){var r=new Blob([e],{type:t||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)return window.navigator.msSaveBlob(r,n);var o=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(r):window.webkitURL.createObjectURL(r),a=document.createElement("a");return a.style.display="none",a.href=o,a.setAttribute("download",n),void 0===a.download&&a.setAttribute("target","_blank"),document.body.appendChild(a),a.click(),setTimeout((function(){document.body.removeChild(a),window.URL.revokeObjectURL(o)}),200)};function l(l){var s,f=this;void 0===l&&(l={});var d=!1;try{d=!!process&&!!(null===(s=null===process||void 0===process?void 0:process.env)||void 0===s?void 0:s.REACT_APP_DEBUG_MODE)}catch(e){d=!1}var v=e(0),b=v[0],h=v[1],p=e(0),w=p[0],y=p[1],g=e(0),m=g[0],k=g[1],C=e(null),R=C[0],E=C[1],L=e(!1),U=L[0],x=L[1],S=n(null),O=t((function(e){var n=e.loaded,t=e.total,r=Math.round(n/t*100);y((function(){return r}))}),[]),T=t((function(e){var n={"Failed to execute 'enqueue' on 'ReadableStreamDefaultController': Cannot enqueue a chunk into an errored readable stream":"Download canceled","The user aborted a request.":"Download timed out"};E((function(){return{errorMessage:n[e.message]?n[e.message]:e.message}}))}),[]),P=t((function(e){S.current=e}),[]),j=t((function(){S.current&&S.current.error()}),[]),A=t((function(){P(null),h((function(){return 0})),y((function(){return 0})),k((function(){return 0})),x((function(){return!1}))}),[P]),D=t((function(e,n,t,r){return void 0===t&&(t=0),void 0===r&&(r={}),a(f,void 0,void 0,(function(){var a,s,f,v;return u(this,(function(u){return U?[2,null]:(A(),E((function(){return null})),x((function(){return!0})),a=setInterval((function(){return h((function(e){return e+1}))}),d?1:1e3),s=c({setSize:k,setControllerCallback:P,setPercentageCallback:O,setErrorCallback:T}),f=new AbortController,v=setTimeout((function(){t>0&&f.abort()}),t),[2,fetch(e,o(o(o({method:"GET"},l),r),{signal:f.signal})).then(s).then((function(e){return e.blob()})).then((function(e){return i(e,n)})).then((function(){return A(),clearInterval(a)})).catch((function(e){return A(),E((function(n){return"Failed to fetch"!==e.message?{errorMessage:e.message}:n})),clearTimeout(v),clearInterval(a)}))])}))}))}),[U,A,d,P,O,T,l]);return r((function(){return{elapsed:b,percentage:w,size:m,download:D,cancel:j,error:R,isInProgress:U}}),[b,w,m,D,j,R,U])}export{l as default,i as jsDownload,c as resolver};
//# sourceMappingURL=index.es.js.map
